<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>七层网络模型 | 个人博客</title>
    <meta name="description" content="记录技术想法">
    <meta name="generator" content="VitePress v1.5.0">
    <link rel="preload stylesheet" href="/blogBuild/assets/style.B64nNUxl.css" as="style">
    <link rel="preload stylesheet" href="/blogBuild/vp-icons.css" as="style">
    
    <script type="module" src="/blogBuild/assets/app.CN4F7Lw9.js"></script>
    <link rel="preload" href="/blogBuild/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/blogBuild/assets/chunks/theme.2qzG9FM2.js">
    <link rel="modulepreload" href="/blogBuild/assets/chunks/framework.DEWO2zTc.js">
    <link rel="modulepreload" href="/blogBuild/assets/knowledge_network_OSIModel_index.md.C_tQ5y-j.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar" data-v-ae24b3ad data-v-6aa21345><div class="wrapper" data-v-6aa21345><div class="container" data-v-6aa21345><div class="title" data-v-6aa21345><div class="VPNavBarTitle has-sidebar" data-v-6aa21345 data-v-1168a8e4><a class="title" href="/blogBuild/" data-v-1168a8e4><!--[--><!--]--><!----><span data-v-1168a8e4>个人博客</span><!--[--><!--]--></a></div></div><div class="content" data-v-6aa21345><div class="content-body" data-v-6aa21345><!--[--><!--]--><div class="VPNavBarSearch search" data-v-6aa21345><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6aa21345 data-v-dc692963><span id="main-nav-aria-label" class="visually-hidden" data-v-dc692963> Main Navigation </span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-dc692963 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-cf11d7a2><span class="text" data-v-cf11d7a2><!----><span data-v-cf11d7a2>MusicPlayer</span><span class="vpi-chevron-down text-icon" data-v-cf11d7a2></span></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><div class="items" data-v-b98bc113><!--[--><!--[--><HelloWorld data-v-b98bc113></HelloWorld><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blogBuild/tech.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>项目技术沉淀</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blogBuild/article.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>优秀文章集合</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blogBuild/knowledge.html" tabindex="0" data-v-dc692963 data-v-e56f3d57><!--[--><span data-v-e56f3d57>计算机科学</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6aa21345 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6aa21345 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6aa21345 data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6aa21345 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-6aa21345><div class="divider-line" data-v-6aa21345></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-17a5e62e><button data-v-17a5e62e>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 is-link" data-v-c40bc020 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/algorithm.html" data-v-b7550ba0><!--[--><h2 class="text" data-v-b7550ba0>数据结构和算法</h2><!--]--></a><!----></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/algorithm/bfs.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>广度优先</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/algorithm/binarySearch.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>二分法</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/algorithm/dp.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>动态规划</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/algorithm/treeSearch.html" data-v-b7550ba0><!--[--><h3 class="text" data-v-b7550ba0>树搜索</h3><!--]--></a><!----></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/algorithm/treeSearch/dfs.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>深度优先， 回溯</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/algorithm/treeSearch/memroySearch.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>记忆化搜索</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 is-link" data-v-c40bc020 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/jsFundation.html" data-v-b7550ba0><!--[--><h2 class="text" data-v-b7550ba0>jsFundation</h2><!--]--></a><!----></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/jsFundation/code.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>基础源码</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/jsFundation/concept.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>js基础概念</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/jsFundation/memory.html" data-v-b7550ba0><!--[--><h3 class="text" data-v-b7550ba0>js内存分配，垃圾回收机制</h3><!--]--></a><!----></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/jsFundation/memory/memoryManagement.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>内存管理</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/jsFundation/promise.html" data-v-b7550ba0><!--[--><h3 class="text" data-v-b7550ba0>promise</h3><!--]--></a><!----></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/jsFundation/promise/asyncControl.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>异步控制</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/jsFundation/promise/overview.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>js单线程概述</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 is-link" data-v-c40bc020 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/ModuleSystem.html" data-v-b7550ba0><!--[--><h2 class="text" data-v-b7550ba0>ModuleSystem</h2><!--]--></a><!----></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/ModuleSystem/moduleSystem.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>js模块系统</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/ModuleSystem/webpack.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>webpack打包工具</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 is-link" data-v-c40bc020 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/network.html" data-v-b7550ba0><!--[--><h2 class="text" data-v-b7550ba0>network</h2><!--]--></a><!----></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/network/dns.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>dns域名介绍</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/network/http.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>http介绍</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/network/https.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>https介绍</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/network/httpVersion.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>http1.0/http2.0</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/network/OSIModel.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>网络模型</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 is-link" data-v-c40bc020 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/webFramework.html" data-v-b7550ba0><!--[--><h2 class="text" data-v-b7550ba0>web框架</h2><!--]--></a><!----></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/blogBuild/knowledge/webFramework/vue.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>vue</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>On this page</div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _blogBuild_knowledge_network_OSIModel_" data-v-39a288b8><div><h1 id="七层网络模型" tabindex="-1">七层网络模型 <a class="header-anchor" href="#七层网络模型" aria-label="Permalink to &quot;七层网络模型&quot;">​</a></h1><h1 id="tcp-ip-网络模型" tabindex="-1">TCP/IP 网络模型 <a class="header-anchor" href="#tcp-ip-网络模型" aria-label="Permalink to &quot;TCP/IP 网络模型&quot;">​</a></h1><h2 id="应用层" tabindex="-1">应用层 <a class="header-anchor" href="#应用层" aria-label="Permalink to &quot;应用层&quot;">​</a></h2><h2 id="传输层" tabindex="-1">传输层 <a class="header-anchor" href="#传输层" aria-label="Permalink to &quot;传输层&quot;">​</a></h2><p><img src="/blogBuild/network/transportLayer.png" alt="An image"></p><h3 id="传输协议" tabindex="-1">传输协议 <a class="header-anchor" href="#传输协议" aria-label="Permalink to &quot;传输协议&quot;">​</a></h3><h4 id="udp结构" tabindex="-1">UDP结构 <a class="header-anchor" href="#udp结构" aria-label="Permalink to &quot;UDP结构&quot;">​</a></h4><p><img src="/blogBuild/network/UDP_Header.png" alt="An image"></p><ol><li>目标和源端口：主要是告诉 UDP 协议应该把报文发给哪个进程。</li><li>包长度：该字段保存了 UDP 首部的长度跟数据的长度之和。</li><li>校验和：校验和是为了提供可靠的 UDP 首部和数据而设计，防止收到在网络传输中受损的 UDP 包。</li></ol><h4 id="tcp结构" tabindex="-1">TCP结构 <a class="header-anchor" href="#tcp结构" aria-label="Permalink to &quot;TCP结构&quot;">​</a></h4><p><img src="/blogBuild/network/TCP_Header.png" alt="An image"></p><ol><li>标和源端口：主要是告诉 TCP 协议应该把报文发给哪个进程。</li><li>序列号：每发送一次数据，累加一次。</li><li>确认应答号:</li><li>控制位：指下一次「期望」收到的数据的序列号，发送端收到这个确认应答以后可以认为在这个序号, 以前的数据都已经被正常接收。用来解决丢包的问题。 TCP 序列号(Seq)和确认号(ACK)的变化规则: 发送的TCP报文(以客户端/服务端视角): 序列号(seq) = 上一次发送的序列号 + len（数据长度）。特殊情况，如果上一次发送的报文是 SYN报文或者 FIN 报文，则改为 上一次发送的序列号 + 1。 确认号(ACK) = 上一次收到的报文中的序列号 + len（数据长度）。 特殊情况，如果收到的是 SYN报文或者 FIN 报文，则改为上一次收到的报文中的序列号 + 1。</li></ol><h4 id="滑动窗口" tabindex="-1">滑动窗口 <a class="header-anchor" href="#滑动窗口" aria-label="Permalink to &quot;滑动窗口&quot;">​</a></h4><p>TCP为了达到有序性，每发送一个数据，都要进行一次确认应答。当上一个数据包收到了应答了，再发送下一个。 如果一个TCP段(Segment), 接着另一个TCP段传输，数据包的往返时间越长，通信的效率就越低。TCP引入窗口概念，即使在往返时间较长的情况下，它也不会降低网络通信的效率。 <img src="/blogBuild/network/TCP_Window.png" alt="An image"> 如上图窗口所示:</p><ol><li>0 - 4的TCP分段已经发送，客户端并接收到ACK应答。</li><li>在窗口中， 一部分是已发送但未确认，这部分可能在网络中丢失，数据必须保留以便必要时重传， 另一部分表示，未发送但可发送，这部分接收方缓冲区还有空间保存，可以发出去；</li><li>最后的部分代表，未发送且暂不可发送，这部分已超出接收方缓冲区存储空间，就算发出去也没意义； 下图表示一系列，客户端向服务端发送数据的过程: <img src="/blogBuild/network/TCP_TimeOut_Retry2.png" alt="An image"></li><li>应用程序读取数据，从缓冲区移除后， 客户端接收到ACK应答， 接收方通告新窗口大小为 15 字节，窗口左边缘向右移动。 <img src="/blogBuild/network/TCP_Window2.png" alt="An image"></li><li>发送方的数据2(序列号从10，长度为4)，为已发送，但待确认。数据3(序列号14, 长度为4)这部分接收方缓冲区还有空间，可以发出</li><li>当数据3发送至服务端时， ACK累计为10, 代表前10个TCP分段已经接收，但从第11个分段开始，服务端没有接收到数据包。因此判断丢包。</li><li>向客户端发起ACK应答报，提示客户端丢包现象存现。客户端重新发送序列号从10开始的，长度为4的字节。</li><li>数据2到达， 接收方将其保存在缓冲区中，并回复 ACK</li><li>数据2， 数据3组成连续数据，可以提交给应用程序读取。</li></ol><h3 id="tcp与udp的差别" tabindex="-1">TCP与UDP的差别 <a class="header-anchor" href="#tcp与udp的差别" aria-label="Permalink to &quot;TCP与UDP的差别&quot;">​</a></h3><h4 id="tcp建立链接与断开连接" tabindex="-1">TCP建立链接与断开连接 <a class="header-anchor" href="#tcp建立链接与断开连接" aria-label="Permalink to &quot;TCP建立链接与断开连接&quot;">​</a></h4><p>三次握手:</p><ol><li>一开始，客户端和服务端都处于CLOSED状态。先是服务端主动监听某个端口，处于LISTEN状态。</li><li>然后客户端主动发送SYN报文，报文中包含初始化序列号(seq)给服务端.</li><li>服务端收到后: 给客户端返回一个ACK报文。报文中包含一个序列号(seq)，和确认应答号(ACK) 。证明服务端能够正常接受客户端</li><li>客户端接收到服务端的ACK报文后, 发送一个ACK报文。 报文中包含对服务端发送的序列号确认的应答号, 证明客户端有接受的能力。</li><li>服务端收到 ACK 的 ACK 之后，处于 ESTABLISHED 状态，因为它也一发一收了。 三次握手目的是保证双方都有发送和接收的能力。</li></ol><p>四次挥手:</p><ol><li>客户端主动调用关闭, 发送 FIN 报文, 这个 FIN 报文代表客户端不会再发送数据了，进入 FIN_WAIT_1 状态。客户端不再发送数据了但是还能接收数据(shuntdown关闭)。</li><li>服务端收到了 FIN 报文，然后马上回复一个 ACK 确认报文， 此时服务端进入 CLOSE_WAIT 状态。TCP 协议栈会为 FIN 包插入一个文件结束符 EOF 到接收缓冲区中。在此状态，服务端可能会继续传输数据。服务端知道客户端不再发送数据，但此时还有数据要发送，不能马上发送FIN报文。将发送 FIN 报文的控制权交给服务端应用程序。 多一次挥手。</li><li>接着，当服务端在读取缓冲区数据的时候, 读取到结束标志，这时服务端应用程序如果有数据要发送的话，就发完数据后才调用关闭连接的函数，如果服务端应用程序没有数据要发送的话，可以直接调用关闭连接的函数。这时服务端就会发一个 FIN包，这个 FIN 报文代表服务端不会再发送数据了，之后处于 LAST_ACK 状态；</li><li>客户端接收到服务端的 FIN 包， 并发送 ACK 确认包给服务端，此时客户端将进入 TIME_WAIT 状态；</li><li>服务端收到 ACK 确认包后，就进入了最后的 CLOSE 状态；</li><li>客户端经过 2MSL(MSL Maximum Segment Lifetime -- 报文最大生存时间) 时间之后，也进入 CLOSE 状态；2MSL等待, 确保服务端正常关闭，服务器如果接收不到ACK应答, 重传报文。确保第四步，服务端正常接收到ACK报文。</li></ol><p>总结: 为何断开链接比建立链接多一次挥手?</p><p>ACK报文是否可以和FIN报文一起发送? 服务端决定什么时候调用关闭连接的函数，当调用了关闭连接的函数，内核就会发送 FIN 报文了，所以服务端的 ACK 和 FIN 一般都会分开发送。</p><p>发送FIN报文的时机是什么? FIN报文发送时机，</p><ol><li>调用关闭连接的函数</li><li>非正常退出应用程序，发送FIN报文。 关闭连接的函数，其实关闭的连接的函数有两种函数</li><li>close函数</li><li>shutdown函数</li></ol><p>四次挥手中乱序FIN包如何处理?</p><h4 id="tcp面向字节流协议-udp为面向报文协议" tabindex="-1">TCP面向字节流协议，UDP为面向报文协议 <a class="header-anchor" href="#tcp面向字节流协议-udp为面向报文协议" aria-label="Permalink to &quot;TCP面向字节流协议，UDP为面向报文协议&quot;">​</a></h4><p>UDP面向报文协议: 当用户消息通过 UDP 协议传输时，操作系统不会对消息进行拆分, 在组装好 UDP 头部后就交给网络层来处理，所以发出去的 UDP 报文中的数据部分就是完整的用户消息。 操作系统在收到 UDP 报文后，会将其插入到队列里，队列里的每一个元素就是一个 UDP 报文。从队列里取出一个数据，然后从内核里拷贝给用户缓冲区。</p><p>TCP面向字节流协议: <img src="/blogBuild/network/TCPSegment.png" alt="An image"> 当用户消息通过 TCP 协议传输时，消息可能会被操作系统分组成多个的 TCP 报文，也就是一个完整的用户消息被拆分成多个 TCP 报文进行传输。因此，我们不能认为一个用户消息对应一个 TCP 报文, 正因为这样，所以 TCP 是面向字节流的协议。</p><h4 id="tcp可靠-udp不可靠" tabindex="-1">TCP可靠, UDP不可靠 <a class="header-anchor" href="#tcp可靠-udp不可靠" aria-label="Permalink to &quot;TCP可靠, UDP不可靠&quot;">​</a></h4><p>TCP可靠性体现在:</p><ol><li>不丢失</li><li>不重复</li><li>按序到达</li></ol><p>TCP为达到可靠性，引入如下机制:</p><ol><li>可靠传入机制, 通过序列号与确认应答。 在 TCP 中，当发送端的数据到达接收主机时，接收端主机会返回一个确认应答消息，表示已收到消息。</li><li>TCP重传机制 2.1 超时重传 <img src="/blogBuild/network/TCP_TimeOut_Retry1.png" alt="An image"> 发送数据时，设定一个定时器，当超过指定的时间后，没有收到对方的ACK 确认应答报文，就会重发该数据。 如何确定超时时间? RTO(超时重传时间) &gt;(略大于) RTT(数据发送时刻到接收到确认的时刻的差值). linux计算RTO: 如果超时重发的数据，再次超时的时候，又需要重传的时候，TCP 的策略是超时间隔加倍。 尚未解决问题:</li><li>超时周期可能相对较长, 需要通过快速重传机制来解决超时重发的时间等待。</li><li>因不知道具体滑动窗口中，哪一个数据包丢失，因此需要重传滑动窗口中所有的数据包。 2.2 快速重传 <img src="/blogBuild/network/TCP_Quick_Retry.png" alt="An image"> 快速重传不依赖定时器的超时，而是依靠基于接收端的反馈信息来引发重传(ACK确认包来进行重传)。 如图所见，服务端没有收到序列号为5的TCP数据包，就收到了序列号为6的数据包，发生乱序现象。与超时重试不同(延时发送)，服务端立即回复ACK报文(ACK的值为当前累计的值)。 通过重复传递相同ACK报文，客户端发现有丢包现象存在，重新发送数据包。 尚未解决问题:</li><li>因不知道具体滑动窗口中，哪一个数据包丢失，因此需要重传滑动窗口中所有的数据包。 2.3 SACK 为了解决超时重传和快速重传的遗留问题，引入SACK重传机制。 TCP 头部字段里加一个 SACK， 它可以将已收到的数据的信息发送给服务端，这样发送方就可以知道哪些数据收到了，哪些数据没收到，知知道了这些信息，就可以只重传丢失的数据。</li></ol><h2 id="_2-4-d-sack" tabindex="-1">2.4 D-SACK <a class="header-anchor" href="#_2-4-d-sack" aria-label="Permalink to &quot;2.4 D-SACK&quot;">​</a></h2><h4 id="tcp流量控制-拥塞机制-udp没有" tabindex="-1">TCP流量控制，拥塞机制， UDP没有 <a class="header-anchor" href="#tcp流量控制-拥塞机制-udp没有" aria-label="Permalink to &quot;TCP流量控制，拥塞机制， UDP没有&quot;">​</a></h4><h4 id="tcp和udp的应用场景" tabindex="-1">TCP和UDP的应用场景 <a class="header-anchor" href="#tcp和udp的应用场景" aria-label="Permalink to &quot;TCP和UDP的应用场景&quot;">​</a></h4><p>TCP的应用场景</p><ol><li>文件传输</li><li>HTTP / HTTPS UDP的应用场景</li><li>包总量较少的通信, 如 DNS 、SNMP 等;</li><li>视频、音频等多媒体通信；</li><li>广播通信;</li></ol><h2 id="网络层" tabindex="-1">网络层 <a class="header-anchor" href="#网络层" aria-label="Permalink to &quot;网络层&quot;">​</a></h2><p><img src="/blogBuild/network/networkLayer.png" alt="An image"></p><h3 id="ip协议-internet-protocol" tabindex="-1">IP协议 Internet Protocol <a class="header-anchor" href="#ip协议-internet-protocol" aria-label="Permalink to &quot;IP协议 Internet Protocol&quot;">​</a></h3><p><img src="/blogBuild/network/IP.png" alt="An image"></p><h3 id="寻址" tabindex="-1">寻址 <a class="header-anchor" href="#寻址" aria-label="Permalink to &quot;寻址&quot;">​</a></h3><h4 id="ip地址" tabindex="-1">IP地址 <a class="header-anchor" href="#ip地址" aria-label="Permalink to &quot;IP地址&quot;">​</a></h4><p><img src="/blogBuild/network/IPAddress.png" alt="An image"><img src="/blogBuild/network/%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81%E8%AE%A1%E7%AE%97%E5%99%A8.png" alt="An image"></p><h4 id="路由" tabindex="-1">路由 <a class="header-anchor" href="#路由" aria-label="Permalink to &quot;路由&quot;">​</a></h4><p><img src="/blogBuild/network/router.png" alt="An image"></p><h2 id="网路接口" tabindex="-1">网路接口 <a class="header-anchor" href="#网路接口" aria-label="Permalink to &quot;网路接口&quot;">​</a></h2><h1 id="参考资料" tabindex="-1">参考资料 <a class="header-anchor" href="#参考资料" aria-label="Permalink to &quot;参考资料&quot;">​</a></h1><ol><li>图解网络: <a href="https://xiaolincoding.com/network/" target="_blank" rel="noreferrer">https://xiaolincoding.com/network/</a></li><li>TCP快速重传机制：<a href="https://www.cnblogs.com/lshs/p/6038547.html" target="_blank" rel="noreferrer">https://www.cnblogs.com/lshs/p/6038547.html</a></li><li>重传机制: <a href="https://zhuanlan.zhihu.com/p/101702312" target="_blank" rel="noreferrer">https://zhuanlan.zhihu.com/p/101702312</a></li><li>TCP的流量控制: <a href="https://fasionchan.com/network/tcp/sliding-window/" target="_blank" rel="noreferrer">https://fasionchan.com/network/tcp/sliding-window/</a></li></ol></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><!----></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/blogBuild/knowledge/algorithm.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>数据结构和算法</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api-examples.md\":\"CdW9MmW8\",\"article_index.md\":\"DH1JsCLz\",\"homepage.md\":\"Cqkqx78S\",\"index.md\":\"B460He1S\",\"knowledge_algorithm_bfs_index.md\":\"Ck5IbHIv\",\"knowledge_algorithm_bfs_readme.md\":\"DQ2r7iVN\",\"knowledge_algorithm_binarysearch_index.md\":\"BmQbjcd6\",\"knowledge_algorithm_binarysearch_readme.md\":\"DcWaTpKi\",\"knowledge_algorithm_dp_index.md\":\"BOR9vo2s\",\"knowledge_algorithm_dp_readme.md\":\"CFApqory\",\"knowledge_algorithm_index.md\":\"C85VJRDl\",\"knowledge_algorithm_readme.md\":\"Cul9ZYUh\",\"knowledge_algorithm_treesearch_dfs_index.md\":\"DgIXTtwF\",\"knowledge_algorithm_treesearch_dfs_readme.md\":\"Bp3Pe3nG\",\"knowledge_algorithm_treesearch_index.md\":\"B55geHQE\",\"knowledge_algorithm_treesearch_memroysearch_index.md\":\"Dvb60TPM\",\"knowledge_algorithm_treesearch_memroysearch_readme.md\":\"Cj5wj8Me\",\"knowledge_algorithm_treesearch_readme.md\":\"C78LWw1V\",\"knowledge_index.md\":\"CN5odMy6\",\"knowledge_jsfundation_code_index.md\":\"BCh5P2yN\",\"knowledge_jsfundation_code_readme.md\":\"C1KGabGX\",\"knowledge_jsfundation_concept_index.md\":\"BKG8EciI\",\"knowledge_jsfundation_concept_readme.md\":\"Cw_vhYFI\",\"knowledge_jsfundation_memory_index.md\":\"C8iQp9bw\",\"knowledge_jsfundation_memory_memorymanagement_index.md\":\"DoYaFrSr\",\"knowledge_jsfundation_memory_memorymanagement_readme.md\":\"BjeXcqgE\",\"knowledge_jsfundation_memory_readme.md\":\"DIVxYp6B\",\"knowledge_jsfundation_promise_asynccontrol_index.md\":\"CDePqMfx\",\"knowledge_jsfundation_promise_asynccontrol_readme.md\":\"DBaFaQ9Q\",\"knowledge_jsfundation_promise_index.md\":\"3yhYWZrw\",\"knowledge_jsfundation_promise_overview_index.md\":\"D3vLfF6b\",\"knowledge_jsfundation_promise_overview_readme.md\":\"CmZF6qWg\",\"knowledge_modulesystem_index.md\":\"cVfWyeMk\",\"knowledge_modulesystem_modulesystem_index.md\":\"C6rfmHfd\",\"knowledge_modulesystem_modulesystem_readme.md\":\"Dz2Z4kuv\",\"knowledge_modulesystem_webpack_index.md\":\"Cx6sfcmF\",\"knowledge_modulesystem_webpack_readme.md\":\"BQtT9ojx\",\"knowledge_network_dns_index.md\":\"DpScfNVI\",\"knowledge_network_dns_readme.md\":\"BIVCzyGP\",\"knowledge_network_http_index.md\":\"L46bJZMR\",\"knowledge_network_http_readme.md\":\"BvK5fLvH\",\"knowledge_network_https_index.md\":\"DphZHFJ1\",\"knowledge_network_https_readme.md\":\"DBkn-Qgy\",\"knowledge_network_httpversion_index.md\":\"e4uxZfRf\",\"knowledge_network_httpversion_readme.md\":\"CbxA_2q9\",\"knowledge_network_osimodel_index.md\":\"C_tQ5y-j\",\"knowledge_network_osimodel_readme.md\":\"CvbQUoK8\",\"knowledge_webframework_index.md\":\"BbFiCE0o\",\"knowledge_webframework_readme.md\":\"BGJ_nUd0\",\"knowledge_webframework_vue_index.md\":\"CR_P5TS8\",\"markdown-examples.md\":\"DrobOnzq\",\"tech_asynchronousflowcontrol_index.md\":\"BzTFrR0O\",\"tech_asynchronousflowcontrol_readme.md\":\"CFbE-7DO\",\"tech_blogarchitecture_index.md\":\"Bzq7m__P\",\"tech_blogarchitecture_readme.md\":\"Nt16j-tS\",\"tech_dfx_index.md\":\"D8Sp6kbc\",\"tech_dfx_memory_case_index.md\":\"CJT7LoBF\",\"tech_dfx_memory_case_readme.md\":\"B8RzfhUc\",\"tech_dfx_memory_index.md\":\"f0ru3NBp\",\"tech_dfx_memory_management_index.md\":\"DRlrXXQE\",\"tech_dfx_memory_management_readme.md\":\"DVa5cchG\",\"tech_dfx_memory_readme.md\":\"Blb_znMF\",\"tech_dfx_memory_tool_index.md\":\"C6c0DHUR\",\"tech_dfx_memory_tool_readme.md\":\"BGRd_tVY\",\"tech_dfx_readme.md\":\"DGvrAFom\",\"tech_dfx_userresponse_index.md\":\"CNVUZada\",\"tech_dfx_userresponse_readme.md\":\"C3ynCU01\",\"tech_index.md\":\"CKDLCajx\",\"tech_methodology_index.md\":\"Dv2Vc6MB\",\"tech_methodology_programmingparadigm_index.md\":\"BQ_Jd40H\",\"tech_methodology_programmingparadigm_oop_index.md\":\"DIZac83r\",\"tech_methodology_programmingparadigm_oop_readme.md\":\"D1wVS3su\",\"tech_methodology_programmingparadigm_readme.md\":\"CKQCRTCc\",\"tech_methodology_readme.md\":\"DPldm2R5\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"个人博客\",\"description\":\"记录技术想法\",\"base\":\"/blogBuild/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"MusicPlayer\",\"items\":[{\"component\":\"HelloWorld\"}]},{\"text\":\"项目技术沉淀\",\"link\":\"/tech\"},{\"text\":\"优秀文章集合\",\"link\":\"/article\"},{\"text\":\"计算机科学\",\"link\":\"/knowledge \"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/vuejs/vitepress\"}],\"sidebar\":{\"/tech/\":[{\"text\":\"导航中使用的异步控制\",\"link\":\"tech/asynchronousFlowControl\",\"items\":[]},{\"text\":\"个人博客技术架构\",\"link\":\"tech/blogArchitecture\",\"items\":[]},{\"text\":\"DFX指标看护\",\"link\":\"tech/dfx\",\"items\":[{\"text\":\"内存看护和管理\",\"link\":\"tech/dfx/memory\",\"items\":[{\"text\":\"内存泄漏案例Case\",\"link\":\"tech/dfx/memory/case\",\"items\":[]},{\"text\":\"内存管理方案\",\"link\":\"tech/dfx/memory/management\",\"items\":[]},{\"text\":\"Profiler检查内存泄漏\",\"link\":\"tech/dfx/memory/tool\",\"items\":[]}]},{\"text\":\"响应时延问题定位与优化\",\"link\":\"tech/dfx/userResponse\",\"items\":[]}]},{\"text\":\"方法论\",\"link\":\"tech/methodology\",\"items\":[{\"text\":\"编程范式\",\"link\":\"tech/methodology/programmingParadigm\",\"items\":[{\"text\":\"面向对象程序设计，建模\",\"link\":\"tech/methodology/programmingParadigm/oop\",\"items\":[]}]}]}],\"/article/\":[{\"text\":\"前端\",\"items\":[{}]},{\"text\":\"ddd领域驱动设计\"}],\"/knowledge/\":[{\"text\":\"数据结构和算法\",\"link\":\"knowledge/algorithm\",\"items\":[{\"text\":\"广度优先\",\"link\":\"knowledge/algorithm/bfs\",\"items\":[]},{\"text\":\"二分法\",\"link\":\"knowledge/algorithm/binarySearch\",\"items\":[]},{\"text\":\"动态规划\",\"link\":\"knowledge/algorithm/dp\",\"items\":[]},{\"text\":\"树搜索\",\"link\":\"knowledge/algorithm/treeSearch\",\"items\":[{\"text\":\"深度优先， 回溯\",\"link\":\"knowledge/algorithm/treeSearch/dfs\",\"items\":[]},{\"text\":\"记忆化搜索\",\"link\":\"knowledge/algorithm/treeSearch/memroySearch\",\"items\":[]}]}]},{\"text\":\"jsFundation\",\"link\":\"knowledge/jsFundation\",\"items\":[{\"text\":\"基础源码\",\"link\":\"knowledge/jsFundation/code\",\"items\":[]},{\"text\":\"js基础概念\",\"link\":\"knowledge/jsFundation/concept\",\"items\":[]},{\"text\":\"js内存分配，垃圾回收机制\",\"link\":\"knowledge/jsFundation/memory\",\"items\":[{\"text\":\"内存管理\",\"link\":\"knowledge/jsFundation/memory/memoryManagement\",\"items\":[]}]},{\"text\":\"promise\",\"link\":\"knowledge/jsFundation/promise\",\"items\":[{\"text\":\"异步控制\",\"link\":\"knowledge/jsFundation/promise/asyncControl\",\"items\":[]},{\"text\":\"js单线程概述\",\"link\":\"knowledge/jsFundation/promise/overview\",\"items\":[]}]}]},{\"text\":\"ModuleSystem\",\"link\":\"knowledge/ModuleSystem\",\"items\":[{\"text\":\"js模块系统\",\"link\":\"knowledge/ModuleSystem/moduleSystem\",\"items\":[]},{\"text\":\"webpack打包工具\",\"link\":\"knowledge/ModuleSystem/webpack\",\"items\":[]}]},{\"text\":\"network\",\"link\":\"knowledge/network\",\"items\":[{\"text\":\"dns域名介绍\",\"link\":\"knowledge/network/dns\",\"items\":[]},{\"text\":\"http介绍\",\"link\":\"knowledge/network/http\",\"items\":[]},{\"text\":\"https介绍\",\"link\":\"knowledge/network/https\",\"items\":[]},{\"text\":\"http1.0/http2.0\",\"link\":\"knowledge/network/httpVersion\",\"items\":[]},{\"text\":\"网络模型\",\"link\":\"knowledge/network/OSIModel\",\"items\":[]}]},{\"text\":\"web框架\",\"link\":\"knowledge/webFramework\",\"items\":[{\"text\":\"vue\",\"link\":\"knowledge/webFramework/vue\",\"items\":[]}]}]}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>